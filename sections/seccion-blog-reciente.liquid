{{ 'component-card.css' | asset_url | stylesheet_tag }}

<div class="custom-cards-section page-width">
  <div class="title-wrapper-with-link">
    <h2 class="title">{{ section.settings.heading | escape }}</h2>
  </div>

  <ul class="articles-wrapper grid grid--1-col grid--3-col-desktop">
    {%- if section.blocks.size > 0 -%}
      {%- for block in section.blocks -%}
        <li class="grid__item" {{ block.shopify_attributes }}>
          <div class="card-wrapper">
            <div class="card card--standard card--media">
              <div class="card__inner">

                {%- comment -%}
                  Bloque de código de imagen mejorado y corregido.
                  Usa el método estándar del tema Dawn para imágenes responsivas.
                {%- endcomment -%}
                {%- if block.settings.image != blank -%}
                  <div class="card__media">
                    <div class="media media--adapt" style="padding-bottom: {{ 1 | divided_by: block.settings.image.aspect_ratio | times: 100 }}%;">
                      <img
                        srcset="{%- if block.settings.image.width >= 375 -%}{{ block.settings.image | image_url: width: 375 }} 375w,{%- endif -%}
                                {%- if block.settings.image.width >= 550 -%}{{ block.settings.image | image_url: width: 550 }} 550w,{%- endif -%}
                                {%- if block.settings.image.width >= 750 -%}{{ block.settings.image | image_url: width: 750 }} 750w,{%- endif -%}
                                {{ block.settings.image | image_url }} {{ block.settings.image.width }}w"
                        src="{{ block.settings.image | image_url: width: 750 }}"
                        sizes="(min-width: 750px) 50vw, 100vw"
                        alt="{{ block.settings.image.alt | escape }}"
                        loading="lazy"
                        width="{{ block.settings.image.width }}"
                        height="{{ block.settings.image.height }}"
                      >
                    </div>
                  </div>
                {%- else -%}
                  <div class="card__media">
                    <div class="media">
                      {{ 'image' | placeholder_svg_tag: 'placeholder-svg' }}
                    </div>
                  </div>
                {%- endif -%}

                <div class="card__content">
                  {%- if block.settings.title != blank -%}
                    <h3 class="card__heading h3">
                      {%- if block.settings.link != blank -%}<a href="{{ block.settings.link }}" class="full-unstyled-link">{%- endif -%}
                        {{ block.settings.title | escape }}
                      {%- if block.settings.link != blank -%}</a>{%- endif -%}
                    </h3>
                  {%- endif -%}
                  
                  {%- if block.settings.description != blank -%}
                    <div class="rte">
                      {{ block.settings.description }}
                    </div>
                  {%- endif -%}
                </div>

              </div>
            </div>
          </div>
        </li>
      {%- endfor -%}
    {%- endif -%}
  </ul>
</div>

{% schema %}
{
  "name": "Tarjetas Personalizadas",
  "tag": "section",
  "class": "section",
  "max_blocks": 3,
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Título de la sección",
      "default": "Mis Tarjetas"
    }
  ],
  "blocks": [
    {
      "type": "card",
      "name": "Tarjeta",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Imagen"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Título",
          "default": "Título de la Tarjeta"
        },
        {
          "type": "richtext",
          "id": "description",
          "label": "Descripción",
          "default": "<p>Escribe aquí la descripción de tu tarjeta.</p>"
        },
        {
          "type": "url",
          "id": "link",
          "label": "Enlace (Opcional)"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Tarjetas Personalizadas",
      "blocks": [
        {
          "type": "card"
        },
        {
          "type": "card"
        },
        {
          "type": "card"
        }
      ]
    }
  ]
}
{% endschema %}